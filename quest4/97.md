##### K8s: Pod 로그를 출력해서 실행 흐름 확인 #####

**1) 로그 확인용 Pod 생성**
```bash
kubectl run counter --image=busybox -- sh -c 'i=0; while true; do echo "Count: $i, Time: $(date)"; i=$((i+1)); sleep 1; done'
```
```tech
bash,busybox,date,echo,kubectl,kubernetes,sh,sleep
```
```desc
#### 📝 로그 생성용 파드 만들기
`kubectl run`을 사용해 1초마다 로그를 출력하는 `counter` 파드를 생성합니다.

- **`kubectl run counter`**: `counter`라는 이름의 파드를 생성
- **`--image=busybox`**: 경량 리눅스 이미지 `busybox` 사용
- **`-- sh -c '...'`**: 파드 안에서 실행할 셸 명령을 지정
- **`while true; do ... done`**: 1초마다 숫자와 시간을 출력하는 무한 루프

> 💡 파드의 동작 상태나 오류를 확인할 때 로그를 보는 것은 매우 중요합니다.
```

**2) Pod가 Running 할때까지 wait**
```bash
kubectl wait --for=condition=Ready pod/counter --timeout=60s
```
```tech
kubectl
```
```desc
#### ⏳ 파드 준비 상태 대기하기
`counter` 파드가 `Ready`(준비 완료) 상태가 될 때까지 기다립니다.

- **`kubectl wait`**: 특정 조건이 만족될 때까지 대기
- **`--for=condition=Ready`**: `Ready` 상태를 기다림
- **`pod/counter`**: 대상 파드 지정
- **`--timeout=60s`**: 최대 60초간 기다림

> 💡 스크립트에서 파드가 완전히 실행된 후에 로그를 조회하는 등 다음 작업을 이어가기 위해 사용됩니다.
```

**3) Pod 상태 확인**
```bash
kubectl get pod counter
```
```tech
bash,kubectl,kubernetes
```
```desc
#### ✅ 파드 상태 확인하기
`kubectl get pod` 명령어로 `counter` 파드의 현재 상태를 확인합니다.

- **`kubectl get pod`**: 파드의 정보를 조회
- **`counter`**: 조회할 파드의 이름
- **STATUS** 컬럼이 `Running`이면 정상적으로 실행 중인 것입니다.

> 💡 파드가 정상적으로 생성되고 실행 중인지 확인할 때 가장 기본적으로 사용하는 명령어입니다.
```

**4) 기본 로그 조회**
```bash
kubectl logs counter
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 📜 기본 로그 조회하기
파드가 지금까지 출력한 전체 로그를 확인합니다.

- **`kubectl logs`**: 파드의 로그를 조회하는 명령어
- **`counter`**: 로그를 확인할 파드의 이름

> 💡 파드가 시작된 후부터 현재까지 쌓인 모든 로그를 한 번에 볼 수 있습니다.
```

**5) 실시간 로그 스트리밍**
```bash
timeout 10 kubectl logs -f counter
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 📡 실시간 로그 스트리밍하기
`-f` 옵션을 사용하여 파드가 생성하는 로그를 실시간으로 계속 확인합니다.

- **`kubectl logs -f`**: **f**ollow의 약자로, 실시간 로그 스트리밍
- **`counter`**: 대상 파드
- **`timeout 10`**: 10초 후에 명령어 자동 종료

> 💡 서비스의 현재 동작을 실시간으로 모니터링할 때 매우 유용합니다. `Ctrl + C`로 종료할 수 있습니다.
```

**6) 최근 일부 로그만 확인**
```bash
kubectl logs counter --tail=5
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 📑 최근 로그만 확인하기
`--tail` 옵션을 사용해 로그의 마지막 N줄만 확인할 수 있습니다.

- **`kubectl logs --tail=5`**: 로그의 마지막 5줄만 출력
- **`counter`**: 대상 파드

> 💡 전체 로그가 너무 길 때, 가장 최근에 발생한 이벤트만 빠르게 확인하고 싶을 때 사용합니다.
```

**7) 컨테이너가 여러 개인 Pod 생성**
```bash
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: multi-container-pod
spec:
  containers:
  - name: nginx-container
    image: nginx
  - name: busybox-container
    image: busybox
    command: ['sh', '-c', 'while true; do echo "Busybox here!"; sleep 5; done']
EOF
```
```tech
bash,cat,kubectl,kubernetes,yaml
```
```desc
#### 📦 멀티 컨테이너 파드 생성하기
하나의 파드 안에 Nginx와 Busybox, 두 개의 컨테이너를 생성합니다.

- **`cat <<EOF | ...`**: YAML 형식의 설정을 표준 입력으로 `kubectl`에 전달
- **`kubectl apply -f -`**: 표준 입력으로 받은 설정으로 리소스를 생성
- **`containers:`**: 파드에 포함될 컨테이너 목록을 정의

> 💡 서로 밀접하게 연관된 프로세스들을 하나의 파드에서 함께 실행할 때 멀티 컨테이너 패턴을 사용합니다.
```

**8) Pod가 Running 할때까지 wait**
```bash
kubectl wait --for=condition=Ready pod/multi-container-pod --timeout=60s
```
```tech
kubectl
```
```desc
#### ⏳ 멀티 컨테이너 파드 준비 대기
`multi-container-pod`의 모든 컨테이너가 준비 완료 상태가 될 때까지 기다립니다.

- **`kubectl wait --for=condition=Ready`**: 파드가 `Ready` 상태가 될 때까지 대기

> 💡 파드 내 모든 컨테이너가 정상적으로 시작되어야 파드는 `Ready` 상태가 됩니다.
```

**9) 특정 컨테이너 로그 확인 (busybox)**
```bash
kubectl logs multi-container-pod -c busybox-container
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 🎯 특정 컨테이너 로그 확인하기
`-c` 옵션을 사용하여 파드 내 여러 컨테이너 중 특정 컨테이너의 로그만 선택하여 확인합니다.

- **`kubectl logs`**: 파드 로그 조회
- **`-c busybox-container`**: **c**ontainer의 약자로, `busybox-container`의 로그를 지정

> 💡 멀티 컨테이너 파드에서 특정 애플리케이션의 로그만 보고 싶을 때 반드시 필요합니다.
```

**10) 특정 컨테이너 로그 확인 (nginx)**
```bash
kubectl logs multi-container-pod -c nginx-container
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 🎯 다른 컨테이너 로그 확인하기
같은 파드 내의 `nginx-container` 로그를 확인합니다.

- **`kubectl logs`**: 파드 로그 조회
- **`-c nginx-container`**: `nginx-container`의 로그를 지정

> 💡 Nginx 컨테이너는 기본적으로 요청이 들어올 때 로그를 남기므로, 아직 로그가 비어있을 수 있습니다.
```

**11) 실습 자원 정리 (counter)**
```bash
kubectl delete pod counter --force --grace-period=0
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 🧹 `counter` 파드 즉시 삭제하기
`counter` 파드를 정상 종료 절차(grace period) 없이 즉시 삭제합니다.

- **`kubectl delete pod`**: 파드를 삭제
- **`--force`**: 강제 삭제 옵션
- **`--grace-period=0`**: 정상 종료 대기 시간을 0초로 설정하여 즉시 종료

> ⚠️ 일반적으로는 정상 종료를 기다리는 것이 좋지만, 불필요한 테스트 자원을 빠르게 정리할 때 사용합니다.
```

**12) 실습 자원 정리 (multi-container)**
```bash
kubectl delete pod multi-container-pod --force --grace-period=0
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 🧹 `multi-container-pod` 즉시 삭제하기
`multi-container-pod`를 정상 종료 절차 없이 즉시 삭제합니다.

- **`kubectl delete pod`**: 파드를 삭제
- **`--force --grace-period=0`**: 강제로 즉시 삭제

> 💡 실습으로 생성한 모든 리소스를 깨끗하게 정리합니다.
```


**13) 실습 종료**

```bash
: quit
```

```tech
bash,rocky
```

```desc
#### 👋 실습 종료
실습을 종료를 의미하는 `quit` 명령어를 실행합니다.
현재 터미널 세션을 종료합니다.

> 💡 모든 실습을 마친 후 사용합니다.
```