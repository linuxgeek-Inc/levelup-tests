##### K8s: YAML νμΌμ„ μ΄μ©ν• Deployment λ°°ν¬ λ° μμ • #####

**1) Deployment μ›λ³Έ YAML νμΌ μƒμ„±**
```bash
kubectl create deployment nginx-yaml-deployment --image=nginx --dry-run=client -o yaml > nginx-original.yaml
```
```tech
bash,kubectl,kubernetes,yaml
```
```desc
#### π“„ Deployment YAML νμΌ μ΄μ• μƒμ„±
μ‹¤μ λ΅ λ¦¬μ†μ¤λ¥Ό μƒμ„±ν•μ§€ μ•κ³ , Deploymentλ¥Ό λ§λ“¤κΈ° μ„ν• YAML νμΌμ λ‚΄μ©μ„ μƒμ„±ν•©λ‹λ‹¤.

- **`--dry-run=client`**: ν΄λΌμ΄μ–ΈνΈ μΈ΅μ—μ„λ§ μ‹¤ν–‰ν•μ—¬ μ„λ²„μ— μ”μ²­μ„ λ³΄λ‚΄μ§€ μ•μµλ‹λ‹¤. λ¦¬μ†μ¤λ¥Ό μƒμ„±ν•λ” λ€μ‹  YAML μ •μλ¥Ό λ§λ“­λ‹λ‹¤.
- **`-o yaml`**: μ¶λ ¥ ν•μ‹μ„ YAMLλ΅ μ§€μ •ν•©λ‹λ‹¤.
- **`>`**: κ²°κ³Όλ¥Ό `nginx-original.yaml` νμΌμ— μ €μ¥ν•©λ‹λ‹¤.

> π’΅ μ΄ λ°©λ²•μ€ μ²μλ¶€ν„° YAMLμ„ μ‘μ„±ν•λ” λ€μ‹ , κΈ°λ³Έ ν…ν”λ¦Ώμ„ λΉ λ¥΄κ² λ§λ“λ” λ° λ§¤μ° μ μ©ν•©λ‹λ‹¤.
```

**2) μ›λ³Έ YAML νμΌ λ‚΄μ© ν™•μΈ**
```bash
cat nginx-original.yaml
```
```tech
bash,cat
```
```desc
#### π‘€ μ›λ³Έ YAML νμΌ λ‚΄μ© ν™•μΈ
μƒμ„±λ Deployment YAML νμΌμ λ‚΄μ©μ„ ν™•μΈν•©λ‹λ‹¤.

- **`cat`**: νμΌμ λ‚΄μ©μ„ ν„°λ―Έλ„μ— μ¶λ ¥ν•©λ‹λ‹¤.

> π’΅ νμΌμ—λ” `apiVersion`, `kind`, `metadata`, `spec` λ“± μΏ λ²„λ„¤ν‹°μ¤ λ¦¬μ†μ¤μ λ¨λ“  ν•„μ ν•„λ“κ°€ ν¬ν•¨λμ–΄ μμµλ‹λ‹¤.
```

**3) `sed`λ¥Ό μ΄μ©ν•΄ λ³µμ λ³Έ κ°μ μμ •**
```bash
sed 's/replicas: 1/replicas: 3/' nginx-original.yaml > nginx-modified.yaml
```
```tech
bash,sed
```
```desc
#### βοΈ `sed`λ΅ λ³µμ λ³Έ κ°μ μμ •
`sed` μ¤νΈλ¦Ό νΈμ§‘κΈ°λ¥Ό μ‚¬μ©ν•μ—¬ λ³µμ λ³Έ(replicas) μλ¥Ό 1μ—μ„ 3μΌλ΅ λ³€κ²½ν•κ³  μƒ νμΌλ΅ μ €μ¥ν•©λ‹λ‹¤.

- **`sed 's/old/new/'`**: `old` λ¬Έμμ—΄μ„ `new` λ¬Έμμ—΄λ΅ μΉν™ν•©λ‹λ‹¤.
- **`nginx-original.yaml`**: μ…λ ¥ νμΌμ…λ‹λ‹¤.
- **`> nginx-modified.yaml`**: λ³€κ²½λ λ‚΄μ©μ„ μƒλ΅μ΄ νμΌμ— μ €μ¥ν•©λ‹λ‹¤.

> π’΅ YAML νμΌμ„ μ§μ ‘ μ—΄μ–΄ μμ •ν•  μλ„ μμ§€λ§, `sed`λ¥Ό μ‚¬μ©ν•λ©΄ μ¤ν¬λ¦½νΈλ¥Ό ν†µν•΄ μλ™ν™”ν•κΈ° νΈλ¦¬ν•©λ‹λ‹¤.
```

**4) μμ •λ YAML νμΌ λ‚΄μ© ν™•μΈ**
```bash
cat nginx-modified.yaml
```
```tech
bash,cat
```
```desc
#### π‘€ μμ •λ YAML νμΌ λ‚΄μ© ν™•μΈ
λ³µμ λ³Έ κ°μκ°€ λ³€κ²½λ μƒλ΅μ΄ YAML νμΌμ λ‚΄μ©μ„ ν™•μΈν•©λ‹λ‹¤.

- **`cat`**: νμΌ λ‚΄μ©μ„ μ¶λ ¥ν•©λ‹λ‹¤.
- `replicas: 3`μΌλ΅ λ³€κ²½λμ—λ”μ§€ ν™•μΈν•©λ‹λ‹¤.

> π’΅ λ°°ν¬ν•κΈ° μ „μ— ν•­μƒ λ³€κ²½ μ‚¬ν•­μ„ λ‹¤μ‹ ν•λ² ν™•μΈν•λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤.
```

**5) colordiff μ„¤μΉ**
```bash
sudo apt install -y colordiff
```
```tech
apt
```
```desc
#### π¨ `colordiff` μ„¤μΉ
λ‘ νμΌμ μ°¨μ΄μ μ„ μƒ‰μƒμΌλ΅ κµ¬λ¶„ν•μ—¬ λ³΄μ—¬μ£Όλ” `colordiff` μ ν‹Έλ¦¬ν‹°λ¥Ό μ„¤μΉν•©λ‹λ‹¤.

- **`sudo apt install -y`**: `apt` ν¨ν‚¤μ§€ λ§¤λ‹μ €λ¥Ό μ‚¬μ©ν•μ—¬ `-y` μµμ…μΌλ΅ μλ™ μ„¤μΉν•©λ‹λ‹¤.
- `diff` λ…λ Ήμ–΄λ³΄λ‹¤ κ°€λ…μ„±μ΄ μΆ‹μµλ‹λ‹¤.

> π’΅ λ°λΉ„μ•/μ°λ¶„ν¬ κ³„μ—΄μ—μ„λ” `apt`, CentOS/RHEL κ³„μ—΄μ—μ„λ” `dnf`λ‚ `yum`μ„ μ‚¬μ©ν•©λ‹λ‹¤.
```

**6) μ›λ³Έκ³Ό μμ •λ³Έμ μ°¨μ΄μ  ν™•μΈ (diff)**
```bash
colordiff -uNrFp nginx-original.yaml nginx-modified.yaml
```
```tech
bash,diff
```
```desc
#### π”„ μ›λ³Έκ³Ό μμ •λ³Έ μ°¨μ΄ λΉ„κµ
λ‘ YAML νμΌ κ°„μ μ°¨μ΄μ μ„ μ‹κ°μ μΌλ΅ ν™•μΈν•©λ‹λ‹¤.

- **`colordiff`**: μƒ‰μƒμΌλ΅ νμΌ μ°¨μ΄λ¥Ό λ³΄μ—¬μ¤λ‹λ‹¤.
- **`-u`**: Unified ν•μ‹μΌλ΅ μ°¨μ΄μ μ„ λ³΄μ—¬μ£Όμ–΄ κ°€λ…μ„±μ„ λ†’μ…λ‹λ‹¤.
- `replicas` ν•„λ“κ°€ μ–΄λ–»κ² λ³€κ²½λμ—λ”μ§€ λ…ν™•ν•κ² λ³Ό μ μμµλ‹λ‹¤.

> π’΅ Gitκ³Ό κ°™μ€ λ²„μ „ κ΄€λ¦¬ μ‹μ¤ν…μ„ μ‚¬μ©ν•λ©΄ μ΄λ¬ν• λ³€κ²½ μ‚¬ν•­μ„ λ”μ± μ²΄κ³„μ μΌλ΅ κ΄€λ¦¬ν•  μ μμµλ‹λ‹¤.
```

**7) μμ •λ YAML νμΌμ„ μ‚¬μ©ν•μ—¬ Deployment λ°°ν¬**
```bash
kubectl apply -f nginx-modified.yaml
```
```tech
bash,kubectl,kubernetes,yaml
```
```desc
#### π€ μμ •λ YAML νμΌλ΅ Deployment λ°°ν¬
μμ •λ YAML νμΌμ λ‚΄μ©λ€λ΅ μΏ λ²„λ„¤ν‹°μ¤ ν΄λ¬μ¤ν„°μ— λ¦¬μ†μ¤λ¥Ό μƒμ„±ν•κ±°λ‚ μ—…λ°μ΄νΈν•©λ‹λ‹¤.

- **`kubectl apply`**: μ„ μ–Έμ  λ°©μ‹(YAMLμ— μ •μλ μƒνƒ)μΌλ΅ λ¦¬μ†μ¤λ¥Ό κ΄€λ¦¬ν•©λ‹λ‹¤.
- **`-f`**: νμΌλ΅λ¶€ν„° λ¦¬μ†μ¤ μ •μλ¥Ό μ½μ–΄μµλ‹λ‹¤.

> π’΅ `kubectl create`λ” λ…λ Ήν• λ°©μ‹, `kubectl apply`λ” μ„ μ–Έν• λ°©μ‹μΌλ΅, λ³΄ν†µ `apply`κ°€ λ” κ¶μ¥λ©λ‹λ‹¤.
```

**8) Deploymentκ°€ μ¤€λΉ„ λ  λ•κΉμ§€ wait**
```bash
kubectl wait --for=condition=available deployment/nginx-yaml-deployment --timeout=60s
```
```tech
kubectl
```
```desc
#### β³ Deployment μ¤€λΉ„ λ€κΈ°
YAML νμΌλ΅ λ°°ν¬ν• Deploymentκ°€ μ™„μ „ν μ¤€λΉ„λ  λ•κΉμ§€ κΈ°λ‹¤λ¦½λ‹λ‹¤.

- **`kubectl wait`**: νΉμ • μ΅°κ±΄μ΄ μ¶©μ΅±λ  λ•κΉμ§€ λ€κΈ°ν•©λ‹λ‹¤.
- **`--for=condition=available`**: λ¨λ“  λ³µμ λ³Έμ΄ μ¤€λΉ„ μƒνƒκ°€ λ  λ•κΉμ§€ κΈ°λ‹¤λ¦½λ‹λ‹¤.

> π’΅ λ°°ν¬κ°€ μ„±κ³µμ μΌλ΅ μ™„λ£λμ—λ”μ§€ ν™•μΈν•λ” κ³Όμ •μ…λ‹λ‹¤.
```

**9) λ°°ν¬ κ²°κ³Ό ν™•μΈ (Deployment)**
```bash
kubectl get deployment nginx-yaml-deployment
```
```tech
bash,kubectl,kubernetes
```
```desc
#### β… λ°°ν¬ κ²°κ³Ό ν™•μΈ (Deployment)
λ°°ν¬λ Deploymentμ μƒνƒλ¥Ό ν™•μΈν•©λ‹λ‹¤.

- **`kubectl get deployment`**: Deploymentμ μ”μ•½ μ •λ³΄λ¥Ό λ³΄μ—¬μ¤λ‹λ‹¤.
- `READY` μ»¬λΌμ΄ `3/3`μΌλ΅ ν‘μ‹λμ–΄, 3κ°μ λ³µμ λ³Έμ΄ λ¨λ‘ μ¤€λΉ„λμ—μμ„ ν™•μΈν•©λ‹λ‹¤.

> π’΅ `replicas: 3` μ„¤μ •μ΄ μ μ μ©λμ—μμ„ μ• μ μμµλ‹λ‹¤.
```

**10) λ°°ν¬ κ²°κ³Ό ν™•μΈ (Pods)**
```bash
kubectl get pods -l app=nginx-yaml-deployment
```
```tech
bash,kubectl,kubernetes
```
```desc
#### β… λ°°ν¬ κ²°κ³Ό ν™•μΈ (Pods)
ν•΄λ‹Ή Deploymentμ— μν•΄ μƒμ„±λ Pod λ©λ΅μ„ ν™•μΈν•©λ‹λ‹¤.

- **`kubectl get pods`**: Pod λ©λ΅μ„ μ΅°νν•©λ‹λ‹¤.
- **`-l app=nginx-yaml-deployment`**: `app` λ μ΄λΈ”λ΅ Podλ¥Ό ν•„ν„°λ§ν•©λ‹λ‹¤.

> π’΅ 3κ°μ Podκ°€ λ¨λ‘ `Running` μƒνƒμΈμ§€ ν™•μΈν•  μ μμµλ‹λ‹¤.
```

**11) μ‹¤μµ μΆ…λ£**

```bash
: quit
```

```tech
bash,rocky
```

```desc
#### π‘‹ μ‹¤μµ μΆ…λ£
μ‹¤μµμ„ μΆ…λ£λ¥Ό μλ―Έν•λ” `quit` λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
ν„μ¬ ν„°λ―Έλ„ μ„Έμ…μ„ μΆ…λ£ν•©λ‹λ‹¤.

> π’΅ λ¨λ“  μ‹¤μµμ„ λ§μΉ ν›„ μ‚¬μ©ν•©λ‹λ‹¤.
```