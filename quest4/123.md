##### μΏ λ²„λ„¤ν‹°μ¤ λ„¤νΈμ›ν¬ κΈ°λ³Έκµ¬μ΅° ν™•μΈ#####

**1) λ…Έλ“ μƒνƒμ™€ λ„¤νΈμ›ν¬ μ •λ³΄ ν™•μΈ**

```bash
kubectl get nodes -o wide
```

```tech
kubectl,get,nodes,wide,k8s,bash
```

```desc
#### π–¥οΈ ν΄λ¬μ¤ν„° λ…Έλ“ μ •λ³΄ ν™•μΈ
ν΄λ¬μ¤ν„°μ— λ“±λ΅λ λ¨λ“  λ…Έλ“μ™€ κ° λ…Έλ“μ μ„Έλ¶€ μƒνƒλ¥Ό μ¶λ ¥ν•©λ‹λ‹¤.

- `-o wide`: κΈ°λ³Έ μ •λ³΄ μ™Έμ— **λ‚΄λ¶€ IP, OS, μ»¤λ„ λ²„μ „, μ»¨ν…μ΄λ„ λ°νƒ€μ„**κΉμ§€ μƒμ„Έ ν™•μΈ
- μ¶λ ¥ ν•­λ©: NAME, STATUS, ROLES, INTERNAL-IP, OS-IMAGE, KERNEL-VERSION λ“±
- λ„¤νΈμ›ν¬ λ¶„μ„ ν¬μΈνΈ: κ° λ…Έλ“μ **λ‚΄λ¶€ IP**λ” νλ“ κ°„ ν†µμ‹ μ κΈ°λ³Έ κ²½λ΅λ΅ ν™μ©λ©λ‹λ‹¤.

> π’΅ μ „μ²΄ λ„¤νΈμ›ν¬ ν† ν΄λ΅μ§€ νμ•…μ μ¶λ°μ μ΄ λλ” λ…λ Ήμ–΄μ…λ‹λ‹¤.
```

**2) λ§μ¤ν„° λ…Έλ“μ— μ§μ ‘ μ ‘μ†**

```bash
ssh k8s-master
```

```tech
ssh,k8s,master,bash
```

```desc
#### π”‘ λ§μ¤ν„° λ…Έλ“ μ ‘μ†
μ μ–΄ λ…Έλ“(Master)μ— μ§μ ‘ μ ‘μ†ν•μ—¬ **λΈλ¦¬μ§€ λ„¤νΈμ›ν¬(cni0)** μ™€ **veth μΈν„°νμ΄μ¤** μƒνƒλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

- λ©μ : νλ“ λ„¤νΈμ›ν¬κ°€ μ‹¤μ  λ¦¬λ…μ¤ λ„¤νΈμ›ν¬ μ¥μΉμ— μ–΄λ–»κ² λ§¤ν•‘λλ”μ§€ κ΄€μ°°
- λ³΄ν†µ μ›μ»¤ λ…Έλ“μ—λ„ μ ‘μ†ν•μ—¬ λΉ„κµ κ΄€μ°°ν•λ©΄ λ” ν¨κ³Όμ μ…λ‹λ‹¤.

> π’΅ μΏ λ²„λ„¤ν‹°μ¤ λ„¤νΈμ›ν¬λ” κ²°κµ­ λ¦¬λ…μ¤ λ„¤νΈμ›ν¬ λ„¤μ„μ¤νμ΄μ¤/λΈλ¦¬μ§€ κΈ°λ°μΌλ΅ λ™μ‘ν•λ‹¤λ” μ μ„ ν™•μΈν•λ” κ³Όμ •μ…λ‹λ‹¤.
```

**3) μ „μ²΄ νλ“ λ„¤νΈμ›ν¬ μ •λ³΄ ν™•μΈ**

```bash
kubectl get pods --all-namespaces -o wide
```

```tech
kubectl,get,pods,wide,k8s,bash
```

```desc
#### π“¦ λ¨λ“  νλ“ λ„¤νΈμ›ν¬ ν™•μΈ
ν΄λ¬μ¤ν„°μ λ¨λ“  λ„¤μ„μ¤νμ΄μ¤μ—μ„ μ‹¤ν–‰ μ¤‘μΈ νλ“μ™€ λ„¤νΈμ›ν¬ μ •λ³΄λ¥Ό μ¶λ ¥ν•©λ‹λ‹¤.

- `-A, --all-namespaces`: λ¨λ“  λ„¤μ„μ¤νμ΄μ¤ ν‘μ‹
- `-o wide`: νλ“μ **Pod IP, μ‹¤ν–‰ μ¤‘μΈ λ…Έλ“λ…**κΉμ§€ ν•¨κ» ν™•μΈ
- ν™μ©: νΉμ • νλ“κ°€ μ–΄λ–¤ λ…Έλ“μ— λ°°μΉλμ–΄ μ–΄λ–¤ IPλ¥Ό λ°›μ•λ”μ§€ μ¶”μ  κ°€λ¥

> π’΅ Pod-to-Pod ν†µμ‹  κ²½λ΅ λ¶„μ„μ κΈ°μ΄ μλ£λ΅ ν™μ©λ©λ‹λ‹¤.
```

**4) μ›Ή μ• ν”λ¦¬μΌ€μ΄μ… λ””ν”λ΅μ΄λ¨ΌνΈ YAML μƒμ„± (λ“λΌμ΄λ°)**

```bash
kubectl create deployment web-deploy --image=reallinux/web-server:3 --replicas=3 --dry-run=client -o yaml > web-deploy.yaml
```

```tech
kubectl,deployment,yaml,generate,k8s,bash
```

```desc
#### π“ λ§¤λ‹νμ¤νΈ νμΌ μƒμ„±
`web-deploy`λΌλ” μ΄λ¦„μ λ””ν”λ΅μ΄λ¨ΌνΈλ¥Ό μ •μν•λ” YAMLμ„ μƒμ„±ν•©λ‹λ‹¤.

- `--image`: μ»¨ν…μ΄λ„ μ΄λ―Έμ§€ μ§€μ • (`reallinux/web-server:3`)
- `--replicas=3`: λ™μΌν• νλ“λ¥Ό 3κ° μƒμ„±ν•λ„λ΅ μ •μ
- `--dry-run=client`: μ‹¤μ  μ μ©μ€ ν•μ§€ μ•κ³  κ²°κ³Όλ§ μ¶λ ¥
- `-o yaml > web-deploy.yaml`: κ²°κ³Όλ¥Ό YAML ν•μ‹μΌλ΅ μ €μ¥

> π’΅ μ§μ ‘ YAMLμ„ μ‘μ„±ν•μ§€ μ•κ³  **μλ™ μƒμ„± ν›„ μμ •/μ μ©**ν•λ” μ‹¤μµ νλ¦„μ„ κ²½ν—ν•  μ μμµλ‹λ‹¤.
```

**5) μƒμ„±λ YAML νμΌ ν™•μΈ**

```bash
cat web-deploy.yaml
```

```tech
cat,yaml,k8s,bash
```

```desc
#### π“– λ§¤λ‹νμ¤νΈ λ‚΄μ© ν™•μΈ
μƒμ„±λ `web-deploy.yaml` νμΌμ λ‚΄μ©μ„ ν™•μΈν•©λ‹λ‹¤.

- μ£Όμ” ν•„λ“: `apiVersion`, `kind`, `metadata`, `spec`
- `replicas: 3`, `containers.image: reallinux/web-server:3` ν™•μΈ
- μ‚¬λμ΄ μ§μ ‘ YAMLμ„ λ‹¤λ£¨λ” κ²ƒλ³΄λ‹¤ **μλ™ μƒμ„± κ²°κ³Όλ¥Ό μ΄ν•΄ν•λ” ν•™μµ**μ— μ΄μ 

> π’΅ λ§¤λ‹νμ¤νΈ κµ¬μ΅°λ¥Ό μ§μ ‘ λμΌλ΅ ν™•μΈν•κ³  μμ •ν•  μ μλ” κΈ°μ΄ λ‹¨κ³„μ…λ‹λ‹¤.
```

**6) λ””ν”λ΅μ΄λ¨ΌνΈ μ μ©**

```bash
kubectl apply -f web-deploy.yaml
```

```tech
kubectl,apply,deployment,k8s,bash
```

```desc
#### π€ λ¦¬μ†μ¤ μ μ©
λ§¤λ‹νμ¤νΈλ¥Ό μ‹¤μ  ν΄λ¬μ¤ν„°μ— λ°μν•μ—¬ νλ“λ¥Ό μƒμ„±ν•©λ‹λ‹¤.

- `apply`: λ³€κ²½ μ‚¬ν•­μ„ λ°μν•κ±°λ‚ μ‹ κ· μƒμ„±
- κΈ°λ€ κ²°κ³Ό: `deployment.apps/web-deploy created`

> π’΅ μ„ μ–Έν• λ°©μ‹μΌλ΅ λ¦¬μ†μ¤λ¥Ό κ΄€λ¦¬ν•λ” μΏ λ²„λ„¤ν‹°μ¤μ ν•µμ‹¬ κ°λ…μ„ μ‹¤μµν•©λ‹λ‹¤.
```

**7) νλ“ μ‹¤ν–‰ μƒνƒ ν™•μΈ (μ μ‹ λ€κΈ° ν›„)**

```bash
sleep 10 && kubectl get all -o wide
```

```tech
kubectl,get,all,wide,k8s,bash
```

```desc
#### β±οΈ λ¦¬μ†μ¤ μƒνƒ μ κ²€
μ μ‹ λ€κΈ° ν›„, λ¨λ“  λ„¤μ„μ¤νμ΄μ¤μ λ””ν”λ΅μ΄λ¨ΌνΈ, λ ν”λ¦¬μΉ΄μ…‹, νλ“ μƒνƒλ¥Ό ν™•μΈν•©λ‹λ‹¤.

- `kubectl get all`: μ„λΉ„μ¤, νλ“, λ””ν”λ΅μ΄λ¨ΌνΈ λ“± μΆ…ν•© μ¶λ ¥
- `-o wide`: νλ“ IPμ™€ λ…Έλ“ λ°°μΉκΉμ§€ μƒμ„Έ ν™•μΈ κ°€λ¥
- κΈ°λ€ κ²°κ³Ό: web-deploy νλ“ 3κ°κ°€ Running μƒνƒ

> π’΅ νλ“κ°€ μ—¬λ¬ λ…Έλ“μ— λ¶„μ‚°λλ”μ§€, μ–΄λ–¤ IPλ¥Ό λ°›λ”μ§€ κ΄€μ°°ν•λ” κ²ƒμ΄ λ„¤νΈμ›ν¬ κµ¬μ΅° ν™•μΈμ ν•µμ‹¬μ…λ‹λ‹¤.
```

**8) νλ“ IPμ— μ§μ ‘ μ ‘κ·Ό ν…μ¤νΈ**

```bash
curl
```

```tech
curl,k8s,network,bash
```

```desc
#### π λ„¤νΈμ›ν¬ μ—°κ²° ν™•μΈ
νλ“ IP λλ” μ„λΉ„μ¤ ClusterIPμ— `curl` μ”μ²­μ„ λ³΄λ‚΄ μ—°κ²°μ„ ν…μ¤νΈν•©λ‹λ‹¤.

- μ •μƒ λ™μ‘ μ‹ μ›Ή μ„λ²„μ μ‘λ‹µ(μ: HTML νμ΄μ§€ μ†μ¤) μ¶λ ¥
- μ‹¤ν¨ μ‹ λ„¤νΈμ›ν¬ μ •μ±…, CNI μ„¤μ •, μ„λΉ„μ¤ κµ¬μ„±μ„ μμ‹¬ν•΄μ•Ό ν•¨

> π’΅ Pod-to-Service λ„¤νΈμ›ν¬ νλ¦„μ„ μ§μ ‘ μ²΄ν—ν•λ” λ‹¨κ³„μ…λ‹λ‹¤.
```

**9) cni0 λΈλ¦¬μ§€ λ„¤νΈμ›ν¬ ν™•μΈ**

```bash
ip addr show | grep -A20 cni0
```
```no-err-check
```

```tech
ip,cni0,bridge,k8s,bash
```

```desc
#### π” CNI λΈλ¦¬μ§€ μΈν„°νμ΄μ¤ ν™•μΈ
νλ“ λ„¤νΈμ›ν¬λ¥Ό μ—°κ²°ν•λ” λ¦¬λ…μ¤ λΈλ¦¬μ§€ **cni0**μ μΈν„°νμ΄μ¤ μ •λ³΄λ¥Ό ν™•μΈν•©λ‹λ‹¤.

- μ¶λ ¥ ν•­λ©: λΈλ¦¬μ§€ MAC, IP, μ„λΈλ„· λ²”μ„
- λ³΄ν†µ Pod IP CIDR λ€μ—­κ³Ό μΌμΉ
- λΈλ¦¬μ§€μ— μ—¬λ¬ veth μΈν„°νμ΄μ¤κ°€ λ¶™μ–΄ μμ

> π’΅ νλ“ λ„¤νΈμ›ν¬μ ν•µμ‹¬ ν—λΈ μ—­ν• μ„ ν•λ” κµ¬μ΅°λ¥Ό λμΌλ΅ ν™•μΈν•©λ‹λ‹¤.
```

**10) veth μΈν„°νμ΄μ¤ ν™•μΈ**

```bash
ip addr show | grep veth
```
```no-err-check
```

```tech
ip,veth,network,k8s,bash
```

```desc
#### π”— νλ“μ™€ λΈλ¦¬μ§€ μ—°κ²°
κ° νλ“λ” νΈμ¤νΈμ™€ veth νμ–΄λ¥Ό ν†µν•΄ μ—°κ²°λ©λ‹λ‹¤.

- ν•μ½ λ: νλ“ λ„¤μ„μ¤νμ΄μ¤ λ‚΄λ¶€ μΈν„°νμ΄μ¤
- λ‹¤λ¥Έμ½ λ: νΈμ¤νΈ cni0 λΈλ¦¬μ§€μ— μ—°κ²°
- μ—¬λ¬ κ°μ vethκ°€ λΈλ¦¬μ§€μ— λ¶™μ–΄ μμΌλ©΄ λ‹¤μμ νλ“κ°€ μ‹¤ν–‰ μ¤‘μ„μ„ μλ―Έ

> π’΅ Pod-to-Bridge μ—°κ²° λ°©μ‹μ„ μ‹¤λ¬΄μ μΌλ΅ μ΄ν•΄ν•λ” ν•µμ‹¬ ν¬μΈνΈμ…λ‹λ‹¤.
```

**11) λΈλ¦¬μ§€ κ΄€λ¦¬ λ„κµ¬ μ„¤μΉ**

```bash
sudo apt install bridge-utils
```

```tech
apt,install,bridge-utils,k8s,bash
```

```desc
#### π› οΈ λΈλ¦¬μ§€ λ„κµ¬ μ„¤μΉ
λ¦¬λ…μ¤ λΈλ¦¬μ§€λ¥Ό ν™•μΈν•λ” λ„κµ¬ `brctl`μ„ μ‚¬μ©ν•κΈ° μ„ν•΄ μ„¤μΉν•©λ‹λ‹¤.

- κΈ°λ³Έμ μΌλ΅ Ubuntu/Debian κ³„μ—΄μ—μ„ μ‚¬μ©
- CentOS/Rocky κ³„μ—΄μ€ `yum install bridge-utils` μ‚¬μ©
- `brctl show` λ…λ ΉμΌλ΅ λΈλ¦¬μ§€-μΈν„°νμ΄μ¤ κ΄€κ³„λ¥Ό ν™•μΈ κ°€λ¥

> π’΅ λ„¤νΈμ›ν¬ κ΄€λ¦¬μλ“¤μ΄ λΈλ¦¬μ§€ ν† ν΄λ΅μ§€ νμ•…μ— μ¦κ²¨ μ“°λ” λ„κµ¬μ…λ‹λ‹¤.
```

**12) λΈλ¦¬μ§€ λ„¤νΈμ›ν¬ κµ¬μ΅° μ¶λ ¥**

```bash
brctl show
```

```tech
brctl,bridge,network,k8s,bash
```

```desc
#### π‰ λΈλ¦¬μ§€ λ„¤νΈμ›ν¬ κµ¬μ΅° ν™•μΈ
νΈμ¤νΈ λ‚΄ λΈλ¦¬μ§€μ™€ κ° μΈν„°νμ΄μ¤μ μ—°κ²° κ΄€κ³„λ¥Ό λ³΄μ—¬μ¤λ‹λ‹¤.

- μ²« μ»¬λΌ: λΈλ¦¬μ§€ μ΄λ¦„ (μ: cni0)
- λ§μ§€λ§‰ μ»¬λΌ: μ—°κ²°λ μΈν„°νμ΄μ¤ λ©λ΅ (μ: vethXXXX)
- Pod-to-Pod ν†µμ‹ μ΄ μ–΄λ–»κ² λΈλ¦¬μ§€λ¥Ό ν†µν•΄ μ΄μ–΄μ§€λ”μ§€ ν™•μΈ κ°€λ¥

> π’΅ μΏ λ²„λ„¤ν‹°μ¤ λ„¤νΈμ›ν¬ κµ¬μ΅°μ μ‹¤μ  μ—°κ²° κ΄€κ³„λ¥Ό μ‹κ°μ μΌλ΅ ν™•μΈν•  μ μμµλ‹λ‹¤.
```

**13) λ§μ¤ν„° λ…Έλ“μ—μ„ μ‹¤ν–‰ μ¤‘μΈ νλ“ ν™•μΈ**

```bash
kubectl get pods --all-namespaces -o wide | grep k8s-master | grep Running | nl
```

```tech
kubectl,get,pods,master,k8s,bash
```

```desc
#### π§Ύ λ§μ¤ν„° λ…Έλ“ νλ“ λ©λ΅
λ§μ¤ν„° λ…Έλ“μ— ν• λ‹Ήλ νλ“λ§ ν•„ν„°λ§ν•΄ λ²νΈμ™€ ν•¨κ» ν™•μΈν•©λ‹λ‹¤.

- `grep k8s-master`: λ§μ¤ν„° λ…Έλ“μ—μ„ μ‹¤ν–‰ μ¤‘μΈ νλ“λ§ ν‘μ‹
- `grep Running`: μ‹¤ν–‰ μ¤‘μΈ νλ“λ§ ν‘μ‹
- `nl`: λΌμΈ λ²νΈ μ¶λ ¥

> π’΅ νΉμ • λ…Έλ“μ—μ„ νλ“κ°€ μ–΄λ–»κ² λ°°μΉλλ”μ§€ μ¶”μ ν•  μ μμµλ‹λ‹¤.
```

**14) λΈλ¦¬μ§€ μ •λ³΄ λ²νΈμ™€ ν•¨κ» μ¶λ ¥**

```bash
brctl show | nl -v 0
```

```tech
brctl,bridge,show,k8s,bash
```

```desc
#### π“ λΈλ¦¬μ§€ λ§¤ν•‘ κµ¬μ΅°
λΈλ¦¬μ§€ μ¶λ ¥ κ²°κ³Όλ¥Ό λ²νΈμ™€ ν•¨κ» ν™•μΈν•©λ‹λ‹¤.

- `nl -v 0`: μ¤„ λ²νΈλ¥Ό 0λ¶€ν„° λ§¤κ²¨ μ¶λ ¥
- μ—¬λ¬ λΈλ¦¬μ§€(cni0, docker0 λ“±)κ°€ κ³µμ΅΄ν•λ” ν™κ²½μ—μ„λ” λ²νΈλ¥Ό λ§¤κ²¨ κ΄€λ¦¬ν•κΈ° νΈλ¦¬

> π’΅ μ—¬λ¬ λΈλ¦¬μ§€ μ •λ³΄λ¥Ό μ •λ¦¬ν•  λ• μ μ©ν•©λ‹λ‹¤.
```

**15) μ‹¤μµ μΆ…λ£**

```bash
: quit
```

```tech
bash,rocky
```

```desc
#### π‘‹ μ‹¤μµ μΆ…λ£
μ‹¤μµμ„ μΆ…λ£λ¥Ό μλ―Έν•λ” `quit` λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.  
ν„μ¬ ν„°λ―Έλ„ μ„Έμ…μ„ μΆ…λ£ν•©λ‹λ‹¤.

> π’΅ λ¨λ“  μ‹¤μµμ„ λ§μΉ ν›„ μ‚¬μ©ν•©λ‹λ‹¤.
```