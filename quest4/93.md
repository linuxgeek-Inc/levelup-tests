##### K8s: kubectl describe로 리소스 상세 정보 보기 #####

**1) 테스트용 리소스 생성**
```bash
kubectl create deployment nginx-describe-test --image=nginx
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 🚀 테스트용 리소스 생성
상세 정보를 조회할 Nginx Deployment를 생성합니다.

- **`kubectl create deployment`**: 새로운 Deployment를 만듭니다.

> 💡 `kubectl describe`는 리소스의 상세한 정보를 보여주어 상태 확인 및 디버깅에 필수적인 명령어입니다.
```

**2) Deployment가 준비 될 때까지 wait**
```bash
kubectl wait --for=condition=available deployment/nginx-describe-test --timeout=60s
```
```tech
kubectl
```
```desc
#### ⏳ Deployment 준비 대기
Deployment가 완전히 준비될 때까지 기다립니다.

- **`kubectl wait`**: 특정 조건이 충족될 때까지 대기합니다.

> 💡 리소스가 안정된 상태에서 정보를 조회해야 정확합니다.
```

**3) Deployment 상태 모니터링**
```bash
timeout 10 watch kubectl get deployment nginx-describe-test
```
```tech
bash,kubectl,kubernetes,watch
```
```desc
#### 👀 Deployment 상태 모니터링
`get` 명령어로 Deployment의 요약 정보를 10초간 확인합니다.

- **`kubectl get`**: 리소스의 핵심 정보를 간략하게 보여줍니다.

> 💡 `get`이 요약 보고서라면, `describe`는 상세 보고서에 비유할 수 있습니다.
```

**4) Deployment 상세 정보 확인**
```bash
kubectl describe deployment nginx-describe-test
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 📜 Deployment 상세 정보 확인
`describe` 명령어로 Deployment의 모든 상세 정보를 확인합니다.

- **`kubectl describe deployment`**: Deployment의 레이블, 복제본 수, 업데이트 전략, 관련 이벤트 등을 자세히 보여줍니다.

> 💡 특히 맨 아래의 `Events` 섹션은 리소스 생성 및 변경 이력을 추적하는 데 매우 유용합니다.
```

**5) Pod 이름 확인**
```bash
POD_NAME=$(kubectl get pods -l app=nginx-describe-test -o name)
```
```tech
bash,echo,kubectl,kubernetes
```
```desc
#### 💾 Pod 이름 변수 저장
상세 정보를 조회할 Pod의 이름을 변수에 저장합니다.

- **`-o name`**: 리소스의 종류와 이름을 `pod/nginx-describe-test-xxxx` 형식으로 출력합니다.

> 💡 `describe` 명령어는 리소스 종류와 이름을 모두 인자로 받을 수 있습니다.
```

```bash
echo "조회할 Pod: $POD_NAME"
```
```tech
bash,echo,kubectl,kubernetes
```
```desc
#### 🗣️ 조회할 Pod 이름 확인
변수에 저장된 Pod의 이름을 확인합니다.
```

**6) Pod 상세 정보 확인**
```bash
kubectl describe $POD_NAME
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 📜 Pod 상세 정보 확인
`describe` 명령어로 Pod의 모든 상세 정보를 확인합니다.

- **`kubectl describe pod`**: Pod의 IP, 노드 위치, 컨테이너 상태, 볼륨, 그리고 가장 중요한 `Events` 정보를 보여줍니다.

> 💡 Pod가 왜 `Pending` 상태인지, 왜 재시작되었는지 등의 원인을 파악할 때 `Events` 섹션을 가장 먼저 확인해야 합니다.
```

**7) 장애 상황 재현용 Deployment 생성**
```bash
kubectl create deployment nginx-error-test --image=nginx:1.99.99
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 💥 장애 상황 재현
존재하지 않는 이미지 태그를 사용하여 의도적으로 오류가 발생하는 Deployment를 생성합니다.

- **`--image=nginx:1.99.99`**: 존재하지 않는 이미지 버전입니다.

> 💡 쿠버네티스는 이 이미지를 가져오려다 실패하고, Pod는 비정상 상태에 빠지게 됩니다.
```

**8) 장애 Pod 상태 확인**
```bash
timeout 10 watch kubectl get pods -l app=nginx-error-test
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 👀 장애 Pod 상태 확인
오류가 발생한 Pod의 상태를 10초간 관찰합니다.

- **`watch`**: 주기적으로 상태를 갱신합니다.

> 💡 Pod의 상태가 `ImagePullBackOff` 또는 `ErrImagePull`로 표시되는 것을 볼 수 있습니다. 이는 이미지를 가져오는 데 실패했음을 의미합니다.
```

**9) 장애 Pod 이름 확인**
```bash
ERROR_POD_NAME=$(kubectl get pods -l app=nginx-error-test -o name)
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 💾 장애 Pod 이름 변수 저장
상세 원인을 파악하기 위해 오류가 발생한 Pod의 이름을 변수에 저장합니다.
```

**10) 장애 Pod 상세 정보 확인**
```bash
kubectl describe $ERROR_POD_NAME
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 🔍 장애 원인 상세 분석
`describe` 명령어로 오류의 상세 원인을 분석합니다.

- **`kubectl describe pod`**: Pod의 상세 정보를 출력합니다.

> 💡 `Events` 섹션을 보면 `Failed to pull image "nginx:1.99.99"` 와 같은 명확한 오류 메시지를 확인할 수 있습니다. 이처럼 `describe`는 문제 해결의 첫걸음입니다.
```

**11) 실습 자원 정리 (정상)**
```bash
kubectl delete deployment nginx-describe-test
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 🧹 실습 자원 정리 (정상)
정상적으로 생성되었던 Deployment를 삭제합니다.
```

**12) 실습 자원 정리 (오류)**
```bash
kubectl delete deployment nginx-error-test
```
```tech
bash,kubectl,kubernetes
```
```desc
#### 🧹 실습 자원 정리 (오류)
오류 상황을 재현했던 Deployment를 삭제합니다.
```
