##### 특정 그룹만 설정 파일에 접근하도록 하려면?#####

**1) nginx를 설치합니다.**

```bash
sudo dnf install -y nginx
```

```tech
dnf,nginx
```

```desc
#### 📦 nginx 설치하기
`dnf` 패키지 관리자를 이용해 nginx 웹 서버를 설치합니다.

- **`dnf install -y nginx`**: 사용자 확인 없이 nginx를 설치
- 설치가 완료되면 `/etc/nginx/nginx.conf` 기본 설정 파일이 생성됩니다.

> 💡 실무에서 자주 사용하는 웹 서버인 nginx 설정 파일을 대상으로 권한 관리를 실습합니다.
```

**2) 실습에 사용할 `senior` 그룹을 생성합니다.**

```bash
sudo groupadd senior
```

```tech
groupadd
```

```desc
#### 👥 시니어 그룹 생성하기
`senior`라는 그룹을 새로 만듭니다.  

- **`groupadd`**: 새 그룹 생성
- **`senior`**: 그룹 이름

> 💡 여기서는 `senior` 그룹만 nginx 설정 파일을 직접 수정할 수 있도록 권한을 줄 예정입니다.
```

**3) `senior` 그룹에 속한 `kevin` 사용자를 생성합니다.**

```bash
sudo useradd -G senior kevin
```

```tech
useradd
```

```desc
#### 👤 시니어 사용자 생성하기
`kevin` 사용자를 만들고 `senior` 그룹에 포함시킵니다.

- **`useradd -G senior kevin`**: `kevin`을 생성하면서 `senior` 그룹에 소속

> 💡 `kevin`은 시니어 엔지니어로 nginx 설정 파일을 수정할 수 있어야 합니다.
```

**4) 비교를 위한 `susan` 사용자를 생성합니다.**

```bash
sudo useradd susan
```

```tech
useradd
```

```desc
#### 👤 주니어 사용자 생성하기
`senior` 그룹에 속하지 않은 `susan` 사용자를 만듭니다.

- **`useradd susan`**: `susan` 계정 생성

> 💡 `susan`은 주니어 엔지니어로 설정 파일에 접근이 차단되어야 합니다.
```

**5) 설정 파일의 소유 그룹을 `senior`로 변경합니다.**

```bash
sudo chgrp senior /etc/nginx/nginx.conf
```

```tech
chgrp
```

```desc
#### 👥 파일 소유 그룹 변경
`chgrp` 명령어로 `nginx.conf`의 소유 그룹을 `senior`로 바꿉니다.

- **`chgrp senior`**: 소유 그룹을 `senior`로 지정
- **`/etc/nginx/nginx.conf`**: 대상 파일

> 💡 이제 `senior` 그룹만이 그룹 권한에 따라 접근할 수 있습니다.
```

**6) nginx 설정 파일의 권한 정보를 확인합니다.**

```bash
getfacl /etc/nginx/nginx.conf
```

```tech
getfacl
```

```desc
#### 👀 설정 파일 권한 확인
`getfacl`로 `nginx.conf` 파일의 소유자와 그룹, 접근 권한을 확인합니다.

- **`getfacl`**: 파일의 ACL(Access Control List) 및 권한 표시
- 기본적으로 소유자는 `root`, 그룹은 `root`, others는 읽기 권한을 가집니다.

> 💡 `ls -l`보다 더 상세하게 권한을 확인할 수 있어 실무에서 자주 활용됩니다.
```

**7) 다른 사용자(others)의 읽기 권한을 제거합니다.**

```bash
sudo chmod o-r /etc/nginx/nginx.conf
```

```tech
chmod
```

```desc
#### 🔒 외부 사용자 권한 제거
`others` 권한을 빼서 `senior` 그룹이 아닌 모든 사용자의 접근을 막습니다.

- **`chmod o-r`**: 다른 사용자들의 읽기 권한 제거
- **`/etc/nginx/nginx.conf`**: 대상 파일

> 💡 이렇게 하면 오직 root와 `senior` 그룹만 설정 파일을 읽을 수 있습니다.
```

**8) 변경된 파일 권한을 확인합니다.**

```bash
getfacl /etc/nginx/nginx.conf
```

```tech
getfacl
```

```desc
#### ✅ 변경된 권한 확인
`getfacl`로 변경 후 파일 권한을 다시 확인합니다.  

- 그룹이 `senior`로 바뀌었는지
- `other::---` 로 표시되는지 확인합니다.

> 💡 이제 `senior` 그룹 외 사용자는 설정 파일에 접근할 수 없습니다.
```

**9) `kevin` 사용자로 설정 파일을 읽을 수 있는지 확인합니다.**

```bash
sudo -u kevin head -n 3 /etc/nginx/nginx.conf
```

```tech
sudo,head
```

```desc
#### ✍️ 시니어 그룹 접근 테스트
`kevin` 계정으로 설정 파일의 앞부분을 읽어봅니다.

- **`sudo -u kevin`**: `kevin` 사용자로 실행
- **`head -n 3`**: 첫 3줄 출력

> 💡 `kevin`은 `senior` 그룹에 속해 있으므로 정상적으로 읽기가 가능해야 합니다.
```

**10) `susan` 사용자로 설정 파일 접근을 시도합니다.**

```bash
sudo -u susan cat /etc/nginx/nginx.conf
```

```no-err-check
```

```tech
sudo,cat
```

```desc
#### 🚫 주니어 그룹 접근 차단 확인
`senior` 그룹에 속하지 않은 `susan`이 설정 파일을 읽으려고 시도합니다.

- **`sudo -u susan`**: `susan` 사용자로 실행
- **`cat`**: 파일 전체 출력 시도

> 💡 "Permission denied"가 발생해야 정상입니다. 이제 `senior` 그룹 외 사용자는 nginx 설정 파일에 접근할 수 없습니다.
```

**11) 실습 종료**

```bash
: quit
```

```tech
bash,rocky
```

```desc
#### 👋 실습 종료
실습을 종료를 의미하는 `quit` 명령어를 실행합니다.
현재 터미널 세션을 종료합니다.

> 💡 모든 실습을 마친 후 사용합니다.
```