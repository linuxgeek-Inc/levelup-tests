##### 8080 포트번호 어떻게 차단하나요 ?#####

**1) iptables 설치**

```bash
sudo dnf install -y iptables
```

```tech
dnf,iptables,bash,rocky
```

```desc
#### 📦 iptables 방화벽 도구 설치하기
`iptables`는 리눅스에서 네트워크 패킷 필터링과 방화벽 규칙을 설정하는 전통적인 도구입니다.

- **`sudo dnf install -y`**: `dnf` 패키지 매니저를 이용해 관리자 권한으로 설치
- **`iptables`**: 설치할 패키지 이름

> 💡 최신 리눅스 배포판에서는 `firewalld`나 `nftables`가 기본 방화벽으로 사용되기도 하지만, `iptables`는 여전히 널리 쓰이고 강력한 기능을 제공합니다.
```

**2) nc 설치**

```bash
sudo dnf install -y nmap-ncat
```

```tech
dnf,nc,bash,rocky
```

```desc
#### 🛠 네트워크 테스트 도구(nc) 설치하기
포트 연결을 테스트하기 위해 `nc`(netcat) 명령어를 설치합니다. `nmap-ncat` 패키지에 포함되어 있습니다.

- **`sudo dnf install -y`**: 관리자 권한으로 `nmap-ncat` 패키지 설치
- **`nmap-ncat`**: `nc` 명령어를 제공하는 패키지

> 💡 `nc`는 '네트워크계의 스위스 아미 나이프'라 불릴 만큼 포트 스캔, 간단한 서버 생성 등 다양한 기능을 가진 유용한 도구입니다.
```

**3) 테스트용으로 포트 8080 리스너 실행**

```bash
nc -l 8080 &
```

```tech
nc,bash,rocky
```

```desc
#### 👂 8080 포트에서 연결 대기하기
`nc`를 이용해 8080번 포트에서 들어오는 네트워크 연결을 기다리는 간단한 리스너(서버)를 백그라운드에서 실행합니다.

- **`nc -l 8080`**: 8080번 포트에서 리스닝(-l) 상태로 대기
- **`&`**: 명령어를 백그라운드에서 실행

> 💡 방화벽 규칙이 제대로 동작하는지 확인하기 위해 이 리스너에 연결을 시도해볼 것입니다.
```

**4) 특정 포트(8080) 차단 규칙 추가**

```bash
sudo iptables -A INPUT -p tcp --dport 8080 -j DROP
```

```tech
iptables,bash,rocky
```

```desc
#### 🚫 8080 포트 트래픽 차단 규칙 추가
`iptables`를 사용하여 8080번 포트로 들어오는 모든 TCP 연결을 차단(DROP)하는 규칙을 추가합니다.

- **`sudo iptables`**: `iptables` 명령을 관리자 권한으로 실행
- **`-A INPUT`**: INPUT 체인(들어오는 패킷)의 마지막에 규칙을 추가(-A)
- **`-p tcp --dport 8080`**: 프로토콜(-p)이 tcp이고 목적지 포트(--dport)가 8080인 패킷을 대상으로 지정
- **`-j DROP`**: 해당 패킷을 버림(DROP)

> 💡 `DROP`은 패킷을 조용히 버리는 반면, `REJECT`는 연결 거부 메시지를 보냅니다.
```

**5) 차단 규칙이 제대로 추가되었는지 확인**

```bash
sudo iptables -L INPUT -v -n | grep 8080
```

```tech
iptables,bash,rocky
```

```desc
#### 📜 방화벽 규칙 확인하기
`iptables`에 방금 추가한 8080 포트 차단 규칙이 제대로 들어갔는지 확인합니다.

- **`sudo iptables -L INPUT`**: INPUT 체인의 규칙 목록(-L)을 보여줌
- **`-v -n`**: 상세 정보(-v)와 숫자 주소(-n)로 표시
- **`| grep 8080`**: 출력 결과에서 '8080'이 포함된 줄만 필터링

> 💡 `dpt:8080`과 `DROP`이 포함된 라인이 보이면 규칙이 성공적으로 추가된 것입니다.
```

**6) 포트 8080에 대한 연결 시도 (nc로 차단 확인)**

```bash
nc -vz 127.0.0.1 8080
```
```no-err-check
```

```tech
nc,bash,rocky
```

```desc
#### 🔗 포트 차단 여부 테스트
`nc`를 이용해 로컬호스트(127.0.0.1)의 8080 포트로 연결을 시도하여 방화벽 규칙이 잘 동작하는지 테스트합니다.

- **`nc -vz`**: 상세한 출력(-v)과 함께 포트 스캔(-z)만 수행
- **`127.0.0.1 8080`**: 접속할 IP 주소와 포트

> 💡 `iptables`의 `DROP` 규칙 때문에 아무런 응답 없이 연결이 타임아웃되어야 정상입니다.
```

**7) iptables 규칙 삭제 (포트 8080 차단 해제)**

```bash
sudo iptables -D INPUT -p tcp --dport 8080 -j DROP
```

```tech
iptables,bash,rocky
```

```desc
#### ✅ 8080 포트 차단 규칙 삭제
추가했던 8080 포트 차단 규칙을 `iptables`에서 삭제하여 다시 포트를 엽니다.

- **`sudo iptables -D INPUT`**: INPUT 체인에서 규칙을 삭제(-D)
- **`...`**: 삭제할 규칙의 내용이 추가할 때와 정확히 일치해야 함

> 💡 `-D` 옵션으로 규칙을 삭제할 때는 추가했을 때 사용한 옵션을 그대로 적어주면 됩니다.
```

**8) iptables 전체 규칙 다시 확인**

```bash
sudo iptables -L -v -n
```

```tech
iptables,bash,rocky
```

```desc
#### 🗑 규칙 삭제 후 전체 목록 확인
`iptables`의 INPUT 체인 규칙 전체 목록을 다시 확인하여 8080 포트 차단 규칙이 성공적으로 삭제되었는지 검증합니다.

- **`sudo iptables -L -v -n`**: INPUT 체인의 모든 규칙을 상세하고 숫자 형식으로 출력

> 💡 출력된 목록에서 이전에 보였던 8080 관련 규칙이 사라졌는지 확인합니다.
```

**9) 포트 8080에 대한 연결 재시도 (연결 확인)**

```bash
nc -vz 127.0.0.1 8080
```

```tech
nc,bash,rocky
```

```desc
#### 🔄 포트 연결 재시도 (성공 확인)
차단 규칙이 삭제되었으므로, 다시 8080 포트로 연결을 시도하여 이번에는 성공하는지 확인합니다.

- **`nc -vz 127.0.0.1 8080`**: 이전과 동일한 연결 테스트 명령어

> 💡 이전에 실행해 둔 `nc -l 8080` 리스너가 여전히 동작 중이므로, 'Connection to 127.0.0.1 8080 port [tcp/*] succeeded!'와 같은 성공 메시지가 출력되어야 합니다.
```

**10) 실습 종료**

```bash
: quit
```

```tech
bash,rocky
```

```desc
#### 👋 실습 종료
실습을 종료를 의미하는 `quit` 명령어를 실행합니다.
현재 터미널 세션을 종료합니다.

> 💡 모든 실습을 마친 후 사용합니다.
```